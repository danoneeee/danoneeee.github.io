<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>отМИМИчКа</title>
<style>
  body {
    margin:0;
    padding:0;
    background: linear-gradient(135deg,#0b0b0b,#1a1a1a);
    font-family: 'Segoe UI', sans-serif;
    color:#eee;
    text-align:center;
  }

  h1 {
    margin-top:20px;
    font-size:2.2em;
    text-shadow: 2px 2px 5px #000;
  }

  .card {
    background: rgba(20,20,20,0.9);
    border-radius:15px;
    display:inline-block;
    padding:15px 25px;
    margin:15px;
    box-shadow: 0 0 15px #000;
  }

  .lock {
    display:flex;
    justify-content:center;
    gap:25px;
    margin:30px;
  }

  .disk {
    width:90px;
    height:90px;
    border-radius:50%;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:36px;
    cursor:pointer;
    user-select:none;
    background: linear-gradient(145deg,#333,#111);
    box-shadow: inset 0 0 10px #555, 0 4px 8px #000;
    transition: transform 0.3s, box-shadow 0.3s, color 0.3s, background 0.3s;
  }

  .disk:hover {
    transform: scale(1.1);
    box-shadow: inset 0 0 12px #777, 0 6px 12px #000;
  }

  button {
    padding:12px 28px;
    font-size:18px;
    background: linear-gradient(145deg,#444,#222);
    color:#ccc;
    border:none;
    border-radius:12px;
    cursor:pointer;
    box-shadow: 0 4px 10px #000;
    transition: transform 0.2s, background 0.2s, color 0.2s;
  }

  button:hover {
    transform: scale(1.05);
    background: linear-gradient(145deg,#555,#333);
    color:#eee;
  }

  #result {
    font-size:1.2em;
    margin-top:15px;
    padding:10px;
  }

  .runes {
    margin-top:25px;
    border-top:1px solid #444;
    padding-top:20px;
  }

  .rune-list {
    display:flex;
    justify-content:center;
    gap:20px;
    font-size:32px;
    padding:10px 0;
    background: rgba(30,30,30,0.7);
    border-radius:12px;
    box-shadow: 0 0 10px #000 inset;
  }

  /* Цвета рун для дисков */
  .disk[data-symbol="☀"]{color:#BFA600;}
  .disk[data-symbol="☾"]{color:#5C9BBF;}
  .disk[data-symbol="✦"]{color:#C05E8C;}
  .disk[data-symbol="⚙"]{color:#7DB32B;}
  .disk[data-symbol="♠"]{color:#BF3D22;}

  .tries {
    font-size:1.1em;
    margin-top:10px;
    padding:8px 15px;
    display:inline-block;
    border-radius:10px;
    background: rgba(40,40,40,0.8);
    box-shadow: 0 0 8px #000 inset;
  }

  /* Анимации */
  @keyframes shake {
    0% { transform: translateX(0); }
    20% { transform: translateX(-5px); }
    40% { transform: translateX(5px); }
    60% { transform: translateX(-5px); }
    80% { transform: translateX(5px); }
    100% { transform: translateX(0); }
  }

  @keyframes shakeStrong {
    0% { transform: translateX(0); }
    20% { transform: translateX(-10px); }
    40% { transform: translateX(10px); }
    60% { transform: translateX(-10px); }
    80% { transform: translateX(10px); }
    100% { transform: translateX(0); }
  }

  @keyframes successAnim {
    0% { transform: scale(1) rotate(0deg); color:#ccc; }
    50% { transform: scale(1.2) rotate(15deg); color:#7FFF7F; }
    100% { transform: scale(1) rotate(0deg); color:#7FFF7F; }
  }

  .shake { animation: shake 0.4s; }
  .shakeStrong { animation: shakeStrong 0.5s; color:#FF6666; }
  .success { animation: successAnim 0.8s forwards; }
</style>
</head>
<body>

<h1>отМИМИчКа</h1>

<div class="card tries">
  Попытки: <span id="tries">6</span>
</div>

<div class="lock">
  <div class="disk" data-symbol="☀" onclick="spin(0)">☀</div>
  <div class="disk" data-symbol="☀" onclick="spin(1)">☀</div>
  <div class="disk" data-symbol="☀" onclick="spin(2)">☀</div>
  <div class="disk" data-symbol="☀" onclick="spin(3)">☀</div>
</div>

<div class="card">
  <button onclick="check()">Проверить</button>
  <p id="result"></p>
</div>

<div class="runes">
  <h3>Алфавит рун замка</h3>
  <div class="rune-list">
    <span>☀</span>
    <span>☾</span>
    <span>✦</span>
    <span>⚙</span>
    <span>♠</span>
  </div>
</div>

<script>
const symbols = ["☀","☾","✦","⚙","♠"];
const disks = document.querySelectorAll(".disk");
const correct = Array.from({length:4}, () =>
  symbols[Math.floor(Math.random()*symbols.length)]
);

let tries = 6;

// Обновляем цвет диска в зависимости от символа
function updateDiskColors() {
  disks.forEach(d => {
    const sym = d.textContent;
    d.dataset.symbol = sym;
  });
}

function spin(i){
  const current = disks[i].textContent;
  const idx = symbols.indexOf(current);
  disks[i].textContent = symbols[(idx+1)%symbols.length];
  updateDiskColors();
}

function animateDisks(className){
  disks.forEach(d => {
    d.classList.add(className);
    setTimeout(() => d.classList.remove(className), className==='success'?800:500);
  });
}

function check(){
  if(tries <= 0) return;

  const attempt = Array.from(disks).map(d => d.textContent);

  let exact = 0;
  let tempCorrect = [];
  let tempAttempt = [];

  for(let i=0;i<4;i++){
    if(attempt[i] === correct[i]){
      exact++;
    } else {
      tempCorrect.push(correct[i]);
      tempAttempt.push(attempt[i]);
    }
  }

  let partial = 0;
  for(let sym of tempAttempt){
    const idx = tempCorrect.indexOf(sym);
    if(idx !== -1){
      partial++;
      tempCorrect.splice(idx,1);
    }
  }

  if(exact === 4){
    animateDisks('success');
    document.getElementById("result").textContent =
      "ЩЕЛЧОК. Все механизмы совпали. Сундук открыт.";
    return;
  }

  tries--;
  document.getElementById("tries").textContent = tries;

  if(tries === 0){
    animateDisks('shakeStrong');
    document.getElementById("result").textContent =
      `Точные: ${exact}, неточные: ${partial}. Замок разламывается — это мимик. Правильная комбинация: ${correct.join('')}`;
  } else {
    animateDisks('shake');
    document.getElementById("result").textContent =
      `Точные совпадения: ${exact}, неточные: ${partial}.`;
  }
}

// Инициализация цветов дисков
updateDiskColors();
</script>

</body>
</html>
